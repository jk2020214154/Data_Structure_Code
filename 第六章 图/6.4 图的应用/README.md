#### 最小生成树

对于一个带权连通无向图 $G=(V,E)$,生成树不同,每棵树的权(即树中所有边上的权值之和)也可能不同,设 $\Re$为 $G$的所有生成树的集合,若 $T$为 $\Re$中边的权值之和最小的那棵生成树，则 $T$称为 $G$的最小生成树( $MST$).

![](https://cdn.acwing.com/media/article/image/2023/10/21/85276_8ca3aaff6f-20200506151404489.png) 

最小生成树的性质：

* 最小生成树不是唯一的,即**最小生成树的树形不唯一**, $\Re$中可能有多个最小生成树.当图 $G$中各边权值互不相同时, $G$的最小生成树是唯一的;若无向连通图 $G$的边数比顶点数少 $1$,即 $G$本身是一棵树时,则 $G$的最小生成树就是它本身.
* 最小生成树的边的权值之和总是唯一的,虽然最小生成树不唯一,但其对应的边的**权值之和总是唯一的且是最小**的.
* 最小生成树的边数为顶点数减 $1$.

##### Prim算法

该算法的时间复杂度为 $O(\left| V \right|^2)$,不依赖于 $\left| E \right|$,它可通过使用**优先队列**把时间复杂度优化为 $O(\left| E\right| \log_{2}{\left| V \right|})$,它适用于求解**边稠密**的图.

该算法可以称为**加点法**,每次迭代选择代价最小的边对应的点,将满足条件的加入到最小生成树中.算法从某个顶点 $s$出发,逐渐覆盖整个连通网的所有顶点.

1. 图的所有顶点集合为 $V$,初始令顶点的集合 `u={s}`,剩余的顶点集合 $v=V-u$;
2. 在两个集合 $u,v$能够组成的边中,选择一条代价最小的边 $e=(u_0,v_0)$,并把这条边加入到最小生成树中,把 $v_0$加入到集合 $u$中;
3. 重复上述步骤,直到最小生成树有 $n-1$条边或者有 $n$个顶点为止.

![](https://cdn.acwing.com/media/article/image/2023/10/21/85276_093e28c86f-20231021174112.png) 

##### Kruskal算法

该算法的时间复杂度为 $O(\left| E \right| \log_{2} \left| E \right|)$,适用于**边稀疏而顶点较多**的图.

该算法可以称为 **加边法** ,初始化最小生成树边数为 $0$,每迭代一次选择一条满足条件的最小代价边,加入到最小生成树的边集合中.

1. 把图中的所有边按代价从小到大排序;
2. 把图中的 $n$个顶点看成独立的 $n$棵树组成的森林;
3. 按权值从小到大选择边,所选的边连接的两个顶点 $u_i,v_i$属于两棵不同的树,使之成为最小生成树的一条边,并将这两棵树合并作为一棵树(**此处用到并查集**);
4. 重复 $(3)$,直到所有顶点都在同一棵树上或者有 $n-1$条边为止.

![](https://cdn.acwing.com/media/article/image/2023/10/21/85276_6f21cfde6f-20231021172957.png) 



